(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{290:function(t,e,a){"use strict";a.r(e);var s=a(13),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"purchaseoffermarket"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#purchaseoffermarket"}},[t._v("#")]),t._v(" PurchaseOfferMarket")]),t._v(" "),e("h3",{attrs:{id:"overview"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[t._v("#")]),t._v(" Overview")]),t._v(" "),e("p",[t._v("The Purchase Offer Market Contract tracks all purchase offers for Indexers and Consumers.\nIt allows Consumers to create/cancel purchase offers, and Indexers to accept the purchase offer to make\nthe service agreements. It is the place Consumer publish a purchase offer for a specific deployment.\nAnd also the place indexers can search and take these purchase offers.")]),t._v(" "),e("h3",{attrs:{id:"terminology"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#terminology"}},[t._v("#")]),t._v(" Terminology")]),t._v(" "),e("p",[t._v("Purchase Offer: A Purchase Offer is created by the Consumer, any Indexer can accept it to make the\nservice agreement.")]),t._v(" "),e("h3",{attrs:{id:"detail"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#detail"}},[t._v("#")]),t._v(" Detail")]),t._v(" "),e("p",[t._v("We design the date structure for Purchase Offer, It stores purchase offer related information.\nA Purchase Offer can accepted by multiple Indexers. Consumer transfer Token to this contract as long as\nthe purchase offer is created. And when Indexer accept the offer, the corresponding part of the money will\ntransfer to serviceAgrementRegistry contract first and wait rewardDistributer contract take and distribute.\nAfter Indexer accept the offer we use the planTemplate that stored in Purchase Offer structure to generate\nthe service agreement.")]),t._v(" "),e("p",[t._v("Consumers can cancel their purchase offer after expire date for free, but if cancel the unexpired Purchase Offer\nwe will charge the penalty fee.")]),t._v(" "),e("h3",{attrs:{id:"purchaseoffer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#purchaseoffer"}},[t._v("#")]),t._v(" PurchaseOffer")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PurchaseOffer")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" deposit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" minimumAcceptHeight"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" minimumStakingAmount"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" planTemplateId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes32")]),t._v(" deploymentId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" expireDate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" consumer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bool")]),t._v(" active"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint16")]),t._v(" limit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint16")]),t._v(" numAcceptedContracts"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"states"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#states"}},[t._v("#")]),t._v(" STATES")]),t._v(" "),e("h3",{attrs:{id:"settings"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#settings"}},[t._v("#")]),t._v(" settings")]),t._v(" "),e("p",[t._v("ISettings contract which stores SubQuery network contracts address")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("contract")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ISettings")]),t._v(" settings\n")])])]),e("h3",{attrs:{id:"offers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#offers"}},[t._v("#")]),t._v(" offers")]),t._v(" "),e("p",[t._v("offerId => Offer")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mapping")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PurchaseOfferMarket")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PurchaseOffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" offers\n")])])]),e("h3",{attrs:{id:"numoffers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#numoffers"}},[t._v("#")]),t._v(" numOffers")]),t._v(" "),e("p",[t._v("number of all offers")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" numOffers\n")])])]),e("h3",{attrs:{id:"penaltyrate"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#penaltyrate"}},[t._v("#")]),t._v(" penaltyRate")]),t._v(" "),e("p",[t._v("penalty rate of consumer cancel the unexpired offer")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" penaltyRate\n")])])]),e("h3",{attrs:{id:"penaltydestination"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#penaltydestination"}},[t._v("#")]),t._v(" penaltyDestination")]),t._v(" "),e("p",[t._v("if penalty destination address is 0x00, then burn the penalty")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" penaltyDestination\n")])])]),e("h3",{attrs:{id:"offerpoi"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#offerpoi"}},[t._v("#")]),t._v(" offerPoi")]),t._v(" "),e("p",[t._v("offerId => Indexer => _poi")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mapping")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mapping")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes32")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" offerPoi\n")])])]),e("h3",{attrs:{id:"events"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#events"}},[t._v("#")]),t._v(" EVENTS")]),t._v(" "),e("h3",{attrs:{id:"purchaseoffercreated"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#purchaseoffercreated"}},[t._v("#")]),t._v(" PurchaseOfferCreated")]),t._v(" "),e("p",[t._v("Emitted when Consumer create a purchase offer")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("event")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PurchaseOfferCreated")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" consumer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" offerId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes32")]),t._v(" deploymentId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" planTemplateId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" deposit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint16")]),t._v(" limit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" minimumAcceptHeight"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" minimumStakingAmount"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" expireDate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h3",{attrs:{id:"purchaseoffercancelled"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#purchaseoffercancelled"}},[t._v("#")]),t._v(" PurchaseOfferCancelled")]),t._v(" "),e("p",[t._v("Emitted when Consumer cancel a purchase offer")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("event")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("PurchaseOfferCancelled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" creator"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" offerId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" penalty"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h3",{attrs:{id:"offeraccepted"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#offeraccepted"}},[t._v("#")]),t._v(" OfferAccepted")]),t._v(" "),e("p",[t._v("Emitted when Indexer accept an offer")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("event")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("OfferAccepted")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" indexer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" offerId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" agreementId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("MODIFIER")]),t._v(" "),e("h3",{attrs:{id:"onlyindexer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#onlyindexer"}},[t._v("#")]),t._v(" onlyIndexer")]),t._v(" "),e("p",[t._v("require caller is indexer")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("modifier")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("onlyIndexer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h3",{attrs:{id:"initialize"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#initialize"}},[t._v("#")]),t._v(" initialize")]),t._v(" "),e("p",[t._v("Initialize this contract to set penaltyRate and penaltyDestination.")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("initialize")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("contract")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ISettings")]),t._v(" _settings"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _penaltyRate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" _penaltyDestination"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Type")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("_settings")]),t._v(" "),e("td",[t._v("contract ISettings")]),t._v(" "),e("td",[t._v("ISettings contract")])]),t._v(" "),e("tr",[e("td",[t._v("_penaltyRate")]),t._v(" "),e("td",[t._v("uint256")]),t._v(" "),e("td",[t._v("penaltyRate that consumer cancel unexpired purchase offer")])]),t._v(" "),e("tr",[e("td",[t._v("_penaltyDestination")]),t._v(" "),e("td",[t._v("address")]),t._v(" "),e("td",[t._v("penaltyDestination that consumer cancel unexpired purchase offer")])])])]),t._v(" "),e("h3",{attrs:{id:"setsettings"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setsettings"}},[t._v("#")]),t._v(" setSettings")]),t._v(" "),e("p",[t._v("Update setting state.")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setSettings")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("contract")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ISettings")]),t._v(" _settings"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Type")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("_settings")]),t._v(" "),e("td",[t._v("contract ISettings")]),t._v(" "),e("td",[t._v("ISettings contract")])])])]),t._v(" "),e("h3",{attrs:{id:"setpenaltyrate"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setpenaltyrate"}},[t._v("#")]),t._v(" setPenaltyRate")]),t._v(" "),e("p",[t._v("allow admin the set the Penalty Rate for cancel unexpired offer.")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setPenaltyRate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _penaltyRate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Type")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("_penaltyRate")]),t._v(" "),e("td",[t._v("uint256")]),t._v(" "),e("td",[t._v("penalty rate to set")])])])]),t._v(" "),e("h3",{attrs:{id:"setpenaltydestination"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setpenaltydestination"}},[t._v("#")]),t._v(" setPenaltyDestination")]),t._v(" "),e("p",[t._v("allow admin to set the Penalty Destination address. All Penalty will transfer to this address, if penalty destination address is 0x00, then burn the penalty.")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setPenaltyDestination")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" _penaltyDestination"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Type")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("_penaltyDestination")]),t._v(" "),e("td",[t._v("address")]),t._v(" "),e("td",[t._v("penalty destination to set")])])])]),t._v(" "),e("h3",{attrs:{id:"createpurchaseoffer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#createpurchaseoffer"}},[t._v("#")]),t._v(" createPurchaseOffer")]),t._v(" "),e("p",[t._v("Allow admin to create a Purchase Offer.")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPurchaseOffer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes32")]),t._v(" _deploymentId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _planTemplateId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _deposit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint16")]),t._v(" _limit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _minimumAcceptHeight"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _minimumStakingAmount"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _expireDate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Type")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("_deploymentId")]),t._v(" "),e("td",[t._v("bytes32")]),t._v(" "),e("td",[t._v("deployment id")])]),t._v(" "),e("tr",[e("td",[t._v("_planTemplateId")]),t._v(" "),e("td",[t._v("uint256")]),t._v(" "),e("td",[t._v("plan template id")])]),t._v(" "),e("tr",[e("td",[t._v("_deposit")]),t._v(" "),e("td",[t._v("uint256")]),t._v(" "),e("td",[t._v("purchase offer value to deposit")])]),t._v(" "),e("tr",[e("td",[t._v("_limit")]),t._v(" "),e("td",[t._v("uint16")]),t._v(" "),e("td",[t._v("limit indexer to accept the purchase offer")])]),t._v(" "),e("tr",[e("td",[t._v("_minimumAcceptHeight")]),t._v(" "),e("td",[t._v("uint256")]),t._v(" "),e("td",[t._v("minimum block height to accept the purchase offer")])]),t._v(" "),e("tr",[e("td",[t._v("_minimumStakingAmount")]),t._v(" "),e("td",[t._v("uint256")]),t._v(" "),e("td",[t._v("minimum staking amount to accept the purchase offer")])]),t._v(" "),e("tr",[e("td",[t._v("_expireDate")]),t._v(" "),e("td",[t._v("uint256")]),t._v(" "),e("td",[t._v("expire date of the purchase offer in unix timestamp")])])])]),t._v(" "),e("h3",{attrs:{id:"cancelpurchaseoffer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cancelpurchaseoffer"}},[t._v("#")]),t._v(" cancelPurchaseOffer")]),t._v(" "),e("p",[t._v("Allow Consumer to cancel their Purchase Offer. Consumer transfer all tokens to this contract when they create the offer. We will charge a Penalty to cancel unexpired Offer. And the Penalty will transfer to a configured address. If the address not configured, then we burn the Penalty.")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cancelPurchaseOffer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _offerId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Type")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("_offerId")]),t._v(" "),e("td",[t._v("uint256")]),t._v(" "),e("td",[t._v("purchase offer id to cancel")])])])]),t._v(" "),e("h3",{attrs:{id:"acceptpurchaseoffer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#acceptpurchaseoffer"}},[t._v("#")]),t._v(" acceptPurchaseOffer")]),t._v(" "),e("p",[t._v("Allow Indexer to accept the offer and make the service agreement.\nThe corresponding part of the money will transfer to serviceAgrementRegistry contract\nand wait rewardDistributer contract take and distribute as long as Indexer accept the offer.\nWhen Indexer accept the offer we need to ensure Indexer's deployment reaches the minimumAcceptHeight,\nSo we ask indexers to pass the latest poi value when accepting the purchase offer,\nand save this poi value when agreement create.")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("acceptPurchaseOffer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _offerId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bytes32")]),t._v(" _poi"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Type")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("_offerId")]),t._v(" "),e("td",[t._v("uint256")]),t._v(" "),e("td",[t._v("purchase offer id to accept")])]),t._v(" "),e("tr",[e("td",[t._v("_poi")]),t._v(" "),e("td",[t._v("bytes32")]),t._v(" "),e("td",[t._v("proof of index (hash) to accept the purchase offer")])])])]),t._v(" "),e("h3",{attrs:{id:"isexpired"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#isexpired"}},[t._v("#")]),t._v(" isExpired")]),t._v(" "),e("p",[t._v("Return the purchase offer is expired")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isExpired")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("uint256")]),t._v(" _offerId"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("view")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("returns")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bool")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Type")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("_offerId")]),t._v(" "),e("td",[t._v("uint256")]),t._v(" "),e("td",[t._v("purchase offer id")])])])]),t._v(" "),e("p",[t._v("Return:  bool -> bool the result of is the purchase offer expired")])])}),[],!1,null,null,null);e.default=n.exports}}]);